<section class="messages-page">
    <div class="header-info">
        <h2>Съобщения</h2>
    </div>
    <div id="loader" ng-show="timeout"></div>
    <p ng-if="loaded && !messages.length">Нямате получени съобщения!</p>
    <!-- <p>Когато получите съобщение, то ще се покаже тук.</p> -->

    <!-- Company table -->
    <table class="messages table" ng-if="user.role === 'COMPANY'">
        <thead>
            <tr>
                <th>Дата</th>
                <th>Съобщение</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="msg in messages">
                <td>{{msg.date | date}}</td>
                <td><strong>{{msg.candidate.name}}</strong> кандидатства по вашата обява - <a href="/advert/{{msg.advertId}}">{{msg.advertTitle}}</a></td>
            </tr>
        </tbody>
    </table>

    <!-- Admin table -->
    <table class="table" ng-if="user.role === 'ADMIN'">
        <thead>
            <tr>
                <th>Подател</th>
                <th>Дата</th>
                <th>Текст</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="msg in messages track by $index" ng-class="{ 'table-primary': !msg.isRead }">
                <td ng-click="showMessage(msg.id)">{{msg.email}}</td>
                <td ng-click="showMessage(msg.id)">{{msg.date | date}}</td>
                <td ng-click="showMessage(msg.id)">{{msg.msg}}</td>
                <!-- <td><button type="button" 
                            class="btn btn-default" 
                            title="Изтрий съобщение" 
                            ng-click="deleteMessage(msg.id, $index, $event)"
                            >&times;</button></td>  -->
                <td><button
                    class="btn btn-danger"
                    mwl-confirm
                    title="Изтриване на съобщение"
                    message="Сигурни ли сте, че искате да изтриете съобщението?"
                    confirm-text="Изтрий"
                    cancel-text="Откажи"
                    placement="bottom"
                    on-confirm="deleteMessage(msg.id, $index)"
                    on-cancel="cancelClicked = true"
                    confirm-button-type="danger"
                    cancel-button-type="default"
                  >&times;</button></td>               
                <!-- <td><a href="/message/{{msg.id}}">Покажи</a></td> -->
            </tr>
        </tbody>
    </table>
</section>